# zsh-autosuggestions の非同期モードを無効化（エラー対策）
ZSH_AUTOSUGGEST_USE_ASYNC=
# 履歴ファイルの保存場所
HISTFILE=~/.zsh_history
HISTSIZE=10000
SAVEHIST=10000
setopt hist_ignore_dups
setopt share_history

# Sheldon の初期化 
eval "$(sheldon source)"

# zsh-vi-modeと競合せずにzsh-history-substring-search の設定
function zvm_after_init() {
  # 上矢印キーと Ctrl + P で履歴検索
  bindkey '^[[A' history-substring-search-up
  bindkey '^P' history-substring-search-up

  # 下矢印キーと Ctrl + N で履歴検索
  bindkey '^[[B' history-substring-search-down
  bindkey '^N' history-substring-search-down
}

# 存在するパスを見つけて読み込む関数
source_if_exists() {
  for p in "$@"; do
    if [ -f "$p" ]; then
      source "$p"
      return 
    fi
  done
}

source_if_exists "${autosuggest_paths[@]}"
source_if_exists "${syntax_highlight_paths[@]}"

autoload -Uz compinit && compinit

# navi をCtrl + gで呼び出し
eval "$(navi widget zsh)" 

# yaziの設定
function y() {
  local tmp="$(mktemp -t "yazi-cmd.XXXXXX)")" cwd
  yazi = "$@" --cwd-file="$tmp"
  if cwd="$(command cat -- "$tmp")" && [ -n "$cwd" ] && [ "$cwd" != "$PWD" ]; then
    builtin cd "$cwd"
  fi

  rm -f -- "$tmp"
}

# zoxide
eval "$(zoxide init zsh)"

# fzf
source <(fzf --zsh)
